# -*- coding: utf-8 -*-
"""Hand Written Digit Prediction - Classification Analysis.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1yW0JbmDHcBBAxLklyM8pZehwNg2P9AO2
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.datasets import fetch_openml
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score

try:
    mnist = pd.read_csv('mnist_784.csv')
    X = mnist.drop('class', axis=1) / 255.0
    y = mnist['class'].astype(int)
except FileNotFoundError:
    mnist = fetch_openml('mnist_784', parser='auto', as_frame=True)
    mnist.frame.to_csv('mnist_784.csv', index=False)
    X = mnist.data / 255.0
    y = mnist.target.astype(int)

X = X / 255.0
y = y.astype(int)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

knn.fit(X_train, y_train)

y_pred = knn.predict(X_test)
print(f'Accuracy: {accuracy_score(y_test, y_pred) * 100:.2f}%')

index = 0
sample = X_test.iloc[index].values.reshape(1, -1)
plt.imshow(sample.reshape(28, 28), cmap='gray')
plt.title(f'Predicted: {knn.predict(pd.DataFrame(sample, columns=X_test.columns))[0]}, Actual: {y_test.iloc[index]}')
plt.show()

